(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.PintarJS||(g.PintarJS={})).UI=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";module.exports={TopLeft:"TopLeft",TopCenter:"TopCenter",TopRight:"TopRight",CenterLeft:"CenterLeft",Center:"Center",CenterRight:"CenterRight",BottomLeft:"BottomLeft",BottomCenter:"BottomCenter",BottomCenterRight:"BottomCenterRight",Auto:"Auto",AutoInline:"AutoInline",Fixed:"Fixed"}},{}],2:[function(require,module,exports){"use strict";const Container=require("./container");const PintarJS=require("./pintar");const SizeModes=require("./size_modes");const SlicedSprite=require("./sliced_sprite");const Paragraph=require("./paragraph");const Anchors=require("./anchors");const Cursors=require("./cursor_types");class Button extends Container{constructor(theme,skin,override){super();var options=this.getOptionsFromTheme(theme,skin,override);this.setBaseOptions(options);this.size.x=100;this.size.xMode=SizeModes.Percents;var textureScale=options.textureScale||1;this.size.y=options.externalSourceRect.height*textureScale;this.size.yMode=SizeModes.Pixels;this.text=null;var initParagraph=paragraph=>{paragraph._setParent(this);paragraph.anchor=Anchors.Center;paragraph.alignment="center"};if(options.paragraphSkin){this._paragraph=new Paragraph(theme,options.paragraphSkin);initParagraph(this._paragraph)}if(options.mouseHoverParagraphSkin){this._paragraphHover=new Paragraph(theme,options.mouseHoverParagraphSkin);initParagraph(this._paragraphHover)}else{this._paragraphHover=this._paragraph}if(options.mouseDownParagraphSkin){this._paragraphDown=new Paragraph(theme,options.mouseDownParagraphSkin);initParagraph(this._paragraphDown)}else{this._paragraphDown=this._paragraphHover||this._paragraph}if(options.externalSourceRect){this._sprite=new SlicedSprite({texture:options.texture,externalSourceRect:options.externalSourceRect,internalSourceRect:options.internalSourceRect,textureScale:textureScale});this._sprite.anchor=Anchors.Fixed}if(options.mouseHoverExternalSourceRect){this._spriteHover=new SlicedSprite({texture:options.texture,externalSourceRect:options.mouseHoverExternalSourceRect,internalSourceRect:options.mouseHoverInternalSourceRect,textureScale:textureScale});this._spriteHover.anchor=Anchors.Fixed}else{this._spriteHover=this._sprite}if(options.mouseDownExternalSourceRect){this._spriteDown=new SlicedSprite({texture:options.texture,externalSourceRect:options.mouseDownExternalSourceRect,internalSourceRect:options.mouseDownInternalSourceRect,textureScale:textureScale});this._spriteDown.anchor=Anchors.Fixed}else{this._spriteDown=this._spriteHover||this._sprite}}get forceSelfStateOnChildren(){return true}get requiredOptions(){return["texture","externalSourceRect","internalSourceRect"]}get isNaturallyInteractive(){return true}get _defaultCursor(){return Cursors.Pointer}draw(pintar){var destRect=this.getBoundingBox();var sprite=this._sprite;if(this._state.mouseDown)sprite=this._spriteDown;else if(this._state.mouseHover)sprite=this._spriteHover;if(sprite){sprite.offset=destRect.getPosition();sprite.size=destRect.getSize();sprite.draw(pintar)}if(this.text){var paragraph=this._paragraph;if(this._state.mouseDown)paragraph=this._paragraphDown;else if(this._state.mouseHover)paragraph=this._paragraphHover;if(paragraph){paragraph.text=this.text;paragraph.draw(pintar)}}}}module.exports=Button},{"./anchors":1,"./container":3,"./cursor_types":4,"./paragraph":9,"./pintar":10,"./size_modes":14,"./sliced_sprite":15}],3:[function(require,module,exports){"use strict";const UIElement=require("./ui_element");const Anchors=require("./anchors");class Container extends UIElement{constructor(){super();this._children=[]}addChild(element){if(element.parent){throw new Error("Element to add already have a parent!")}this._children.push(element);element._setParent(this)}removeChild(element){if(element.parent!==this){throw new Error("Element to remove does not belong to this container!")}var index=this._children.indexOf(element);if(index!==-1){this._children.splice(index,1);element._setParent(null)}}iterateChildren(callback){for(var i=this._children.length-1;i>=0;--i){var child=this._children[i];if(child)callback(child)}}getInternalBoundingBox(){var ret=this.getBoundingBox();var padding=this.padding?this._convertSides(this.padding):{top:0,bottom:0,left:0,right:0};ret.x+=padding.left;ret.y+=padding.top;ret.width-=padding.right+padding.left;ret.height-=padding.bottom+padding.top;return ret}get forceSelfStateOnChildren(){return false}draw(pintar){for(var i=0;i<this._children.length;++i){this._children[i].draw(pintar)}}update(input,forceState){super.update(input,forceState);var lastElement=null;for(var i=0;i<this._children.length;++i){var element=this._children[i];var needToSetAuto=false;if(element.anchor===Anchors.AutoInline){if(lastElement){var marginX=Math.max(element.margin.left,lastElement.margin.right);var marginY=Math.max(element.margin.top,lastElement.margin.bottom);element.offset.set(lastElement.offset.x+lastElement.size.x+marginX,lastElement.offset.y+lastElement.size.y+marginY);if(element.offset.x>this.size.x){needToSetAuto=true}}else{var padding=this._convertSides(this.padding);element.offset.set(Math.max(element.margin.left-padding.left,0),Math.max(element.margin.top-padding.top,0))}}if(needToSetAuto||element.anchor===Anchors.Auto){if(lastElement){var marginY=Math.max(element.margin.top,lastElement.margin.bottom);var marginX=Math.max(element.margin.left-padding.left,0);element.offset.set(marginX,lastElement.offset.y+lastElement.size.y+marginY)}else{var padding=this._convertSides(this.padding);element.offset.set(Math.max(element.margin.left-padding.left,0),Math.max(element.margin.top-padding.top,0))}}element.update(input,forceState||(this.forceSelfStateOnChildren?this._state:null));lastElement=element}}}module.exports=Container},{"./anchors":1,"./ui_element":17}],4:[function(require,module,exports){module.exports={Default:"default",Pointer:"pointer"}},{}],5:[function(require,module,exports){"use strict";const UIElement=require("./ui_element");const PintarJS=require("./pintar");const SizeModes=require("./size_modes");class HorizontalLine extends UIElement{constructor(theme,skin,override){super();var options=this.getOptionsFromTheme(theme,skin,override);this.setBaseOptions(options);this.size.x=100;this.size.xMode=SizeModes.Percents;var textureScale=options.textureScale||1;this.size.y=options.middleSourceRect.height*textureScale;this.size.yMode=SizeModes.Pixels;var leftSideSourceRect=options.leftEdgeSourceRect;if(leftSideSourceRect){this._leftEdgeSprite=new PintarJS.Sprite(options.texture);this._leftEdgeSprite.sourceRectangle=leftSideSourceRect;this._leftEdgeSprite.size.set(leftSideSourceRect.width*textureScale,leftSideSourceRect.height*textureScale)}var rightSideSourceRect=options.rightEdgeSourceRect;if(rightSideSourceRect){this._rightEdgeSprite=new PintarJS.Sprite(options.texture);this._rightEdgeSprite.sourceRectangle=rightSideSourceRect;this._rightEdgeSprite.size.set(rightSideSourceRect.width*textureScale,rightSideSourceRect.height*textureScale)}this._middleSprite=new PintarJS.Sprite(options.texture);this._textureScale=options.textureScale;this._middleSourceRect=options.middleSourceRect}get requiredOptions(){return["texture","middleSourceRect"]}draw(pintar){var destRect=this.getBoundingBox();var widthLeft=destRect.width;var offsetX=0;if(this._leftEdgeSprite){this._leftEdgeSprite.position.set(destRect.x,destRect.y);pintar.drawSprite(this._leftEdgeSprite);widthLeft-=this._leftEdgeSprite.size.x;offsetX+=this._leftEdgeSprite.size.x}if(this._rightEdgeSprite){this._rightEdgeSprite.position.set(destRect.right-this._rightEdgeSprite.width,destRect.y);pintar.drawSprite(this._rightEdgeSprite);widthLeft-=this._rightEdgeSprite.size.x}if(this._middleSprite){this._middleSprite.sourceRectangle=this._middleSourceRect.clone();this._middleSprite.size.set(this._middleSourceRect.width*this._textureScale,this._middleSourceRect.height*this._textureScale);while(widthLeft>0){this._middleSprite.position.set(destRect.x+offsetX,destRect.y);if(this._middleSprite.size.x>widthLeft){var toCut=this._middleSprite.size.x-widthLeft;this._middleSprite.size.x-=toCut;this._middleSprite.sourceRectangle.width-=toCut/this._textureScale}pintar.drawSprite(this._middleSprite);widthLeft-=this._middleSprite.size.x;offsetX+=this._middleSprite.size.x}}}}module.exports=HorizontalLine},{"./pintar":10,"./size_modes":14,"./ui_element":17}],6:[function(require,module,exports){var UI={UIRoot:require("./root"),UIElement:require("./ui_element"),ProgressBar:require("./progress_bar"),InputManager:require("./input_manager"),Container:require("./container"),Anchors:require("./anchors"),SlicedSprite:require("./sliced_sprite"),SizeModes:require("./size_modes"),SidesProperties:require("./sides_properties"),Panel:require("./panel"),Paragraph:require("./paragraph"),HorizontalLine:require("./horizontal_line"),Button:require("./button"),Sprite:require("./sprite"),UIPoint:require("./ui_point"),CursorTypes:require("./cursor_types")};const pintar=require("./pintar");pintar.UI=UI;module.exports=UI},{"./anchors":1,"./button":2,"./container":3,"./cursor_types":4,"./horizontal_line":5,"./input_manager":7,"./panel":8,"./paragraph":9,"./pintar":10,"./progress_bar":11,"./root":12,"./sides_properties":13,"./size_modes":14,"./sliced_sprite":15,"./sprite":16,"./ui_element":17,"./ui_point":18}],7:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");class InputManager{constructor(pintar){var canvas=this._canvas=pintar._canvas;this._mouseButtons={0:false,1:false,2:false};this._mouseClicks={0:false,1:false,2:false};this._mouseWheel=0;this._mousePosition=new PintarJS.Point(0,0);this.setCursorDefault();this._mouseDownEventListener=(e=>{this._mouseButtons[e.button]=true});canvas.addEventListener("mousedown",this._mouseDownEventListener);this._mouseUpEventListener=(e=>{if(this._mouseButtons[e.button]){this._mouseClicks[e.button]=true}this._mouseButtons[e.button]=false});canvas.addEventListener("mouseup",this._mouseUpEventListener);this._mouseLeaveEventListener=(e=>{this._mouseButtons[0]=this._mouseButtons[1]=this._mouseButtons[2]=false});canvas.addEventListener("mouseleave",this._mouseLeaveEventListener);this._mouseWheelEventListener=(e=>{this._mouseWheel=e.deltaY});canvas.addEventListener("mousewheel",this._mouseWheelEventListener);this._mouseMoveEventListener=(e=>{this._mousePosition=new PintarJS.Point(e.offsetX,e.offsetY)});canvas.addEventListener("mousemove",this._mouseMoveEventListener)}cleanup(){canvas.removeEventListener("mousedown",this._mouseDownEventListener);canvas.removeEventListener("mouseup",this._mouseUpEventListener);canvas.removeEventListener("mouseleave",this._mouseLeaveEventListener);canvas.removeEventListener("mousewheel",this._mouseWheelEventListener);canvas.removeEventListener("mousemove",this._mouseMoveEventListener)}startUpdate(){var timeNow=(new Date).getTime();this._deltaTime=this._prevTime?(timeNow-this._prevTime)/1e3:.1;this._prevTime=timeNow}endUpdate(){this._mouseWheel=0;this._mouseClicks[0]=this._mouseClicks[1]=this._mouseClicks[2]=false;this.setCursorDefault()}get cursorType(){return this._cursorType}setCursorDefault(){this._cursorType="default"}setCursor(cursorType){this._cursorType=cursorType}get mousePosition(){return this._mousePosition.clone()}get leftMouseDown(){return this._mouseButtons[0]}get rightMouseDown(){return this._mouseButtons[2]}get leftMouseClick(){return this._mouseClick[0]}get rightMouseClick(){return this._mouseClick[2]}get mouseWheelChange(){return this._mouseWheel}get deltaTime(){return this._deltaTime}}module.exports=InputManager},{"./pintar":10}],8:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");const Container=require("./container");const SlicedSprite=require("./sliced_sprite");class Panel extends Container{constructor(theme,skin,override){super();var options=this.getOptionsFromTheme(theme,skin,override);this.setBaseOptions(options);this.padding=options.padding||new SidesProperties(10,10,10,10);this._background=new SlicedSprite(options);this._background._setParent(this);this._background.ignoreParentPadding=true}get requiredOptions(){return["texture","externalSourceRect","internalSourceRect"]}draw(pintar){this._background.draw(pintar);super.draw(pintar)}update(input,forceState){super.update(input,forceState);if(this._background){this._background.update(input,forceState);this._background.size=this.size}}}module.exports=Panel},{"./container":3,"./pintar":10,"./sliced_sprite":15}],9:[function(require,module,exports){"use strict";const UIElement=require("./ui_element");const PintarJS=require("./pintar");const SizeModes=require("./size_modes");class Paragraph extends UIElement{constructor(theme,skin,override){super();var options=this.getOptionsFromTheme(theme,skin,override);this.setBaseOptions(options);this.size.x=100;this.size.xMode=SizeModes.Percents;this.enableLineBreaking=true;this.centerTextVertically=true;this._textSprite=new PintarJS.TextSprite("");this._textSprite.useStyleCommands=Boolean(options.useStyleCommands);if(options.font!==undefined){this._textSprite.font=options.font}if(options.fontSize!==undefined){this._textSprite.fontSize=options.fontSize}if(options.alignment!==undefined){this._textSprite.alignment=options.alignment}if(options.fillColor!==undefined){this._textSprite.color=options.fillColor}if(options.strokeColor!==undefined){this._textSprite.strokeColor=options.strokeColor}if(options.strokeWidth!==undefined){this._textSprite.strokeWidth=options.strokeWidth}this.autoSetHeight=true;this.autoSetWidth=false}get text(){return this._textSprite.text}set text(text){if(this._textSprite.text!==text){this._textSprite.text=text}}get alignment(){return this._textSprite.alignment}set alignment(val){this._textSprite.alignment=val}get requiredOptions(){return[]}draw(pintar){if(this.autoSetHeight){this.size.yMode=SizeModes.Pixels;this.size.y=this._textSprite.calculatedHeight}if(this.autoSetWidth){this.size.xMode=SizeModes.Pixels;this.size.x=this._textSprite.calculatedWidth}var destRect=this.getBoundingBox();var position=destRect.getPosition();if(this.centerTextVertically){this._textSprite.lineHeightOffsetFactor=1/1.25}else{this._textSprite.lineHeightOffsetFactor=1/2}this._textSprite.position=position;this._textSprite.maxWidth=this.enableLineBreaking&&!this.autoSetWidth?destRect.width:0;if(this.alignment=="center"){this._textSprite.position.x+=destRect.width/2+1}if(this.alignment=="right"){this._textSprite.position.x+=destRect.width}pintar.drawText(this._textSprite)}}module.exports=Paragraph},{"./pintar":10,"./size_modes":14,"./ui_element":17}],10:[function(require,module,exports){var pintar=window.PintarJS||window.pintar;if(!pintar){throw new Error("Missing PintarJS main object.")}module.exports=pintar},{}],11:[function(require,module,exports){"use strict";const Container=require("./container");const PintarJS=require("./pintar");const SlicedSprite=require("./sliced_sprite");const Sprite=require("./sprite");const Anchors=require("./anchors");const SizeModes=require("./size_modes");const Utils=require("./utils");class ProgressBar extends Container{constructor(theme,skin,override){super();var options=this.getOptionsFromTheme(theme,skin,override);this.setBaseOptions(options);if(options.foregroundSourceRect&&(options.foregroundExternalSourceRect||options.foregroundInternalSourceRect)){throw new Error("Option 'foregroundSourceRect' cannot appear with options 'foregroundExternalSourceRect' or 'foregroundInternalSourceRect'!")}if(options.fillSourceRect&&(options.fillInternalSourceRect||options.fillExternalSourceRect)){throw new Error("Option 'fillSourceRect' cannot appear with options 'fillInternalSourceRect' or 'fillExternalSourceRect'!")}if(options.backgroundSourceRect&&(options.backgroundInternalSourceRect||options.backgroundExternalSourceRect)){throw new Error("Option 'backgroundSourceRect' cannot appear with options 'backgroundInternalSourceRect' or 'backgroundExternalSourceRect'!")}this.fillOffset=options.fillOffset||PintarJS.Point.zero();var textureScale=this._textureScale=options.textureScale||1;if(options.backgroundSourceRect){this._backgroundSprite=new Sprite({texture:options.texture,sourceRect:options.backgroundSourceRect,textureScale:textureScale})}else if(options.backgroundExternalSourceRect){this._backgroundSprite=new SlicedSprite({texture:options.texture,externalSourceRect:options.backgroundExternalSourceRect,internalSourceRect:options.backgroundInternalSourceRect,textureScale:textureScale})}else{throw new Error("Progress bars must have a background sprite!")}this._backgroundSprite.color=options.backgroundColor||PintarJS.Color.white();this._backgroundSprite.anchor=Anchors.Fixed;if(options.fillSourceRect){this.spriteFillSourceRect=options.fillSourceRect;this._fillSprite=new Sprite({texture:options.texture,sourceRect:options.fillSourceRect,textureScale:textureScale})}else if(options.fillExternalSourceRect){this._fillSprite=new SlicedSprite({texture:options.texture,externalSourceRect:options.fillExternalSourceRect,internalSourceRect:options.fillInternalSourceRect,textureScale:textureScale})}else{throw new Error("Missing progressbar fill part source rect!")}var fillRect=options.fillExternalSourceRect||options.fillSourceRect;var backRect=options.backgroundExternalSourceRect||options.backgroundSourceRect;this._fillSprite.color=options.fillColor||PintarJS.Color.white();this._fillSprite.anchor=Anchors.Fixed;this._fillWidthToRemove=backRect?Math.round(backRect.width-fillRect.width):0;this._fillHeightToRemove=backRect?Math.round(backRect.height-fillRect.height):0;if(options.foregroundSourceRect){this._foregroundSprite=new Sprite({texture:options.texture,sourceRect:options.foregroundSourceRect,textureScale:textureScale})}else if(options.foregroundExternalSourceRect){this._foregroundSprite=new SlicedSprite({texture:options.texture,externalSourceRect:options.foregroundExternalSourceRect,internalSourceRect:options.foregroundInternalSourceRect,textureScale:textureScale})}if(this._foregroundSprite){this._foregroundSprite.color=options.foregroundColor||PintarJS.Color.white();this._foregroundSprite.anchor=Anchors.Fixed}this.fillPartAnchor=options.fillAnchor||Anchors.TopLeft;if(options.fillSourceRect){this.size.y=options.fillSourceRect.height*textureScale;this.size.x=options.fillSourceRect.width*textureScale}else{this.size.y=options.height||(backRect||fillRect).height*textureScale;this.size.x=100;this.size.xMode=SizeModes.Percents}this.animationSpeed=options.animationSpeed||0;if(options.valueSetWidth===undefined){options.valueSetWidth=true}this.setWidth=Boolean(options.valueSetWidth);this.setHeight=Boolean(options.valueSetHeight);this._displayValue=this.value=0}get requiredOptions(){return["texture"]}get fillColor(){return this._fillSprite.color}set fillColor(color){this._fillSprite.color=color}get fillBlendMode(){return this._fillSprite.blendMode}set fillBlendMode(blendMode){this._fillSprite.blendMode=blendMode}draw(pintar){var dest=this.getBoundingBox();this._backgroundSprite.offset=dest.getPosition();this._backgroundSprite.size=dest.getSize();this._backgroundSprite.draw(pintar);var value=this._displayValue;if(value>0){if(this.spriteFillSourceRect){this._fillSprite.sourceRectangle=this.spriteFillSourceRect.clone();if(this.setWidth){this._fillSprite.sourceRectangle.width=Math.floor((this._backgroundSprite.sourceRectangle.width-this._fillWidthToRemove)*value);this._fillSprite.size.x=this._fillSprite.sourceRectangle.width*this._textureScale;if(this.fillPartAnchor.indexOf("right")!==-1){this._fillSprite.sourceRectangle.x=Math.floor(this.spriteFillSourceRect.right-this._fillSprite.sourceRectangle.width)}}if(this.setHeight){this._fillSprite.sourceRectangle.height=Math.floor((this._backgroundSprite.sourceRectangle.height-this._fillHeightToRemove)*value);this._fillSprite.size.y=this._fillSprite.sourceRectangle.height*this._textureScale;if(this.fillPartAnchor.indexOf("Bottom")!==-1){this._fillSprite.sourceRectangle.y=Math.floor(this.spriteFillSourceRect.bottom-this._fillSprite.sourceRectangle.height)}}this._fillSprite.offset=this.getDestTopLeftPositionForRect(dest,this._fillSprite.size,this.fillPartAnchor,this.fillOffset)}else{this._fillSprite.size.x=Math.floor((this._backgroundSprite.size.x-this._fillWidthToRemove*this._textureScale)*(this.setWidth?value:1));this._fillSprite.size.y=Math.floor((this._backgroundSprite.size.y-this._fillHeightToRemove*this._textureScale)*(this.setHeight?value:1));this._fillSprite.offset=this.getDestTopLeftPositionForRect(dest,this._fillSprite.size,this.fillPartAnchor,this.fillOffset)}this._fillSprite.draw(pintar)}if(this._foregroundSprite){this._foregroundSprite.offset=dest.getPosition();this._foregroundSprite.size=dest.getSize();this._foregroundSprite.draw(pintar)}super.draw(pintar)}get displayedValue(){return this._displayValue}update(input,forceState){super.update(input,forceState);if(this._displayValue!=this.value){if(!this.animationSpeed){this._displayValue=this.value}else{this._displayValue=Utils.MoveTowards(this._displayValue,this.value,input.deltaTime*this.animationSpeed)}}if(this._displayValue<0)this._displayValue=0;if(this._displayValue>1)this._displayValue=1}}module.exports=ProgressBar},{"./anchors":1,"./container":3,"./pintar":10,"./size_modes":14,"./sliced_sprite":15,"./sprite":16,"./utils":19}],12:[function(require,module,exports){"use strict";const Container=require("./container");const PintarJS=require("./pintar");const InputManager=require("./input_manager");class UIRoot extends Container{constructor(pintar,inputManager){super({UIRoot:{default:{}}});this.pintar=pintar;this.inputManager=inputManager||new InputManager(pintar)}cleanup(){this.inputManager.cleanup()}getBoundingBox(){return this.pintar.canvasRect}getInternalBoundingBox(){return this.pintar.canvasRect}draw(pintar){super.draw(this.pintar)}update(input){this.inputManager.startUpdate();super.update(this.inputManager);this.inputManager.endUpdate()}}module.exports=UIRoot},{"./container":3,"./input_manager":7,"./pintar":10}],13:[function(require,module,exports){"use strict";class SidesProperties{constructor(left,right,top,bottom){this.left=left||0;this.right=right||0;this.top=top||0;this.bottom=bottom||0;this.leftMode=this.rightMode=this.topMode=this.bottomMode="px"}set(left,right,top,bottom){this.left=left;this.right=right;this.top=top;this.bottom=bottom}clone(){var ret=new SidesProperties(this.left,this.right,this.top,this.bottom);ret.leftMode=this.leftMode;ret.rightMode=this.rightMode;ret.topMode=this.topMode;ret.bottomMode=this.bottomMode;return ret}}module.exports=SidesProperties},{}],14:[function(require,module,exports){"use strict";module.exports={Pixels:"px",Percents:"%"}},{}],15:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");const UIElement=require("./ui_element");class SlicedSprite extends UIElement{constructor(options,skin,override){super();if(skin){options=this.getOptionsFromTheme(options,skin,override);this.setBaseOptions(options)}var texture=options.texture;var textureScale=options.textureScale||1;var wholeSourceRect=this._externalSourceRect=options.externalSourceRect;var fillSourceRect=this._internalSourceRect=options.internalSourceRect;var fillMode=options.fillMode||SlicedSprite.FillModes.Tiled;this._leftFrameSourceRect=new PintarJS.Rectangle(wholeSourceRect.x,fillSourceRect.y,fillSourceRect.x-wholeSourceRect.x,fillSourceRect.height);this._rightFrameSourceRect=new PintarJS.Rectangle(fillSourceRect.right,fillSourceRect.y,wholeSourceRect.right-fillSourceRect.right,fillSourceRect.height);this._topFrameSourceRect=new PintarJS.Rectangle(fillSourceRect.x,wholeSourceRect.y,fillSourceRect.width,fillSourceRect.y-wholeSourceRect.y);this._bottomFrameSourceRect=new PintarJS.Rectangle(fillSourceRect.x,fillSourceRect.bottom,fillSourceRect.width,wholeSourceRect.bottom-fillSourceRect.bottom);this._topLeftFrameCornerSourceRect=new PintarJS.Rectangle(wholeSourceRect.x,wholeSourceRect.y,fillSourceRect.x-wholeSourceRect.x,fillSourceRect.y-wholeSourceRect.y);this._topRightFrameCornerSourceRect=new PintarJS.Rectangle(fillSourceRect.right,wholeSourceRect.y,wholeSourceRect.right-fillSourceRect.right,fillSourceRect.y-wholeSourceRect.y);this._bottomLeftFrameCornerSourceRect=new PintarJS.Rectangle(wholeSourceRect.x,fillSourceRect.bottom,fillSourceRect.x-wholeSourceRect.x,wholeSourceRect.bottom-fillSourceRect.bottom);this._bottomRightFrameCornerSourceRect=new PintarJS.Rectangle(fillSourceRect.right,fillSourceRect.bottom,wholeSourceRect.right-fillSourceRect.right,wholeSourceRect.bottom-fillSourceRect.bottom);this._topFrameSprite=new PintarJS.Sprite(texture);this._bottomFrameSprite=new PintarJS.Sprite(texture);this._leftFrameSprite=new PintarJS.Sprite(texture);this._rightFrameSprite=new PintarJS.Sprite(texture);this._topLeftCornerFrameSprite=new PintarJS.Sprite(texture);this._bottomLeftCornerFrameSprite=new PintarJS.Sprite(texture);this._topRightCornerFrameSprite=new PintarJS.Sprite(texture);this._bottomRightCornerFrameSprite=new PintarJS.Sprite(texture);this._fillSprite=new PintarJS.Sprite(texture);this.fillColor=options.fillColor||PintarJS.Color.white();this.frameColor=options.frameColor||PintarJS.Color.white();this.frameScale=textureScale;this.fillScale=textureScale;this.blendMode=PintarJS.BlendModes.AlphaBlend;this.fillMode=fillMode||SlicedSprite.FillModes.Tiled}get requiredOptions(){return["texture","externalSourceRect","internalSourceRect"]}get sourceRectangle(){return this._externalSourceRect}set color(color){this.fillColor=color.clone();this.frameColor=color.clone()}draw(pintar){var destRect=this.getBoundingBox();var scaleFactor=this.absoluteScale;var frameScale=scaleFactor*this.frameScale;var position=destRect.getPosition();destRect.width-=this._bottomRightFrameCornerSourceRect.width*frameScale;destRect.height-=this._bottomRightFrameCornerSourceRect.height*frameScale;if(destRect.width>0&&destRect.height>0){var drawTopAndBottomFrames=(sprite,sourceRect,extraY)=>{if(sourceRect.width==0||sourceRect.height==0){return}sprite.sourceRectangle=sourceRect.clone();sprite.origin=PintarJS.Point.zero();sprite.position=position.clone();sprite.blendMode=this.blendMode;sprite.position.y+=extraY;sprite.position.x+=this._topLeftFrameCornerSourceRect.width*frameScale;sprite.width=sprite.sourceRectangle.width*frameScale;sprite.height=sprite.sourceRectangle.height*frameScale;sprite.color=this.frameColor;var exceededRightSide=false;while(!exceededRightSide){var spriteRight=sprite.position.x+sprite.width;exceededRightSide=spriteRight>=destRect.right;if(exceededRightSide){var toCut=spriteRight-destRect.right;if(toCut>0){sprite.sourceRectangle.width-=Math.round(toCut*(sprite.sourceRectangle.width/sprite.width));sprite.width-=toCut}}pintar.drawSprite(sprite);sprite.position.x+=sprite.width}};drawTopAndBottomFrames(this._topFrameSprite,this._topFrameSourceRect,0);drawTopAndBottomFrames(this._bottomFrameSprite,this._bottomFrameSourceRect,destRect.height);var drawLeftAndRightFrames=(sprite,sourceRect,extraX)=>{if(sourceRect.width==0||sourceRect.height==0){return}sprite.sourceRectangle=sourceRect.clone();sprite.origin=PintarJS.Point.zero();sprite.position=position.clone();sprite.blendMode=this.blendMode;sprite.position.x+=extraX;sprite.position.y+=this._topLeftFrameCornerSourceRect.height*frameScale;sprite.width=sprite.sourceRectangle.width*frameScale;sprite.height=sprite.sourceRectangle.height*frameScale;sprite.color=this.frameColor;var exceededBottomSide=false;while(!exceededBottomSide){var spriteBottom=sprite.position.y+sprite.height;exceededBottomSide=spriteBottom>=destRect.bottom;if(exceededBottomSide){var toCut=spriteBottom-destRect.bottom;if(toCut>0){sprite.sourceRectangle.height-=Math.round(toCut*(sprite.sourceRectangle.height/sprite.height));sprite.height-=toCut}}pintar.drawSprite(sprite);sprite.position.y+=sprite.height}};drawLeftAndRightFrames(this._leftFrameSprite,this._leftFrameSourceRect,0);drawLeftAndRightFrames(this._rightFrameSprite,this._rightFrameSourceRect,destRect.width);var drawFramesCorner=(sprite,sourceRect,posx,posy)=>{if(sourceRect.width==0||sourceRect.height==0){return}sprite.sourceRectangle=sourceRect.clone();sprite.origin=PintarJS.Point.zero();sprite.position=position.clone();sprite.blendMode=this.blendMode;sprite.position.x+=posx;sprite.position.y+=posy;sprite.width=sprite.sourceRectangle.width*frameScale;sprite.height=sprite.sourceRectangle.height*frameScale;sprite.color=this.frameColor;pintar.drawSprite(sprite)};drawFramesCorner(this._topLeftCornerFrameSprite,this._topLeftFrameCornerSourceRect,0,0);drawFramesCorner(this._topRightCornerFrameSprite,this._topRightFrameCornerSourceRect,destRect.width,0);drawFramesCorner(this._bottomLeftCornerFrameSprite,this._bottomLeftFrameCornerSourceRect,0,destRect.height);drawFramesCorner(this._bottomRightCornerFrameSprite,this._bottomRightFrameCornerSourceRect,destRect.width,destRect.height)}if(this._internalSourceRect.width&&this._internalSourceRect.height){var sprite=this._fillSprite;sprite.origin=PintarJS.Point.zero();sprite.position=position.clone();sprite.blendMode=this.blendMode;sprite.position.x+=this._topLeftCornerFrameSprite.width;sprite.position.y+=this._topLeftCornerFrameSprite.height;sprite.width=destRect.width-this._bottomLeftCornerFrameSprite.width;sprite.height=destRect.height-this._bottomLeftCornerFrameSprite.height;sprite.color=this.fillColor;if(this.fillMode===SlicedSprite.FillModes.Stretch){sprite.sourceRectangle=this._internalSourceRect.clone();pintar.drawSprite(sprite)}else if(this.fillMode===SlicedSprite.FillModes.Tiled){var fillScale=scaleFactor*this.fillScale;var fillSize=new PintarJS.Point(Math.max(this._internalSourceRect.width*fillScale,1),Math.max(this._internalSourceRect.height*fillScale,1));sprite.size=fillSize.clone();var startPosition=sprite.position.clone();for(var i=0;i<destRect.width/fillSize.x;++i){sprite.sourceRectangle=this._internalSourceRect.clone();sprite.size.x=fillSize.x;sprite.position.x=startPosition.x+sprite.width*i;if(sprite.position.x>=this._rightFrameSprite.position.x){break}var spriteRight=sprite.position.x+sprite.size.x;if(spriteRight>this._rightFrameSprite.position.x){var toCut=spriteRight-this._rightFrameSprite.position.x;if(toCut>0){sprite.sourceRectangle.width-=Math.round(toCut*(sprite.sourceRectangle.width/sprite.width));sprite.width-=toCut}}if(sprite.width==0){break}for(var j=0;j<destRect.height/fillSize.y;++j){sprite.size.y=fillSize.y;sprite.position.y=startPosition.y+sprite.height*j;if(sprite.position.y>=this._bottomFrameSprite.position.y){break}var spriteBottom=sprite.position.y+sprite.size.y;if(spriteBottom>this._bottomFrameSprite.position.y){var toCut=spriteBottom-this._bottomFrameSprite.position.y;if(toCut>0){sprite.sourceRectangle.height-=Math.round(toCut*(sprite.sourceRectangle.height/sprite.height));sprite.height-=toCut}}if(sprite.height==0){break}pintar.drawSprite(sprite)}}}else if(this.fillMode===SlicedSprite.FillModes.None){}else{throw new Error("Invalid fill mode!")}}}}SlicedSprite.FillModes={Tiled:1,Stretch:2,None:3};module.exports=SlicedSprite},{"./pintar":10,"./ui_element":17}],16:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");const UIElement=require("./ui_element");class Sprite extends UIElement{constructor(options,skin,override){super();if(skin){options=this.getOptionsFromTheme(options,skin,override);this.setBaseOptions(options)}var texture=options.texture;var textureScale=options.textureScale||1;var sourceRect=options.sourceRect;if(options.textureScale&&!sourceRect){throw new Error("When providing 'textureScale' option for UI Sprite you must also provide the sourceRect option!")}this._sprite=new PintarJS.Sprite(texture);if(sourceRect){this._sprite.sourceRectangle=sourceRect.clone();this.size.x=sourceRect.width*textureScale;this.size.y=sourceRect.height*textureScale}}get requiredOptions(){return["texture"]}get color(){return this._sprite.color}set color(val){this._sprite.color=val}get sourceRectangle(){return this._sprite.sourceRectangle}set sourceRectangle(val){this._sprite.sourceRectangle=val}draw(pintar){var destRect=this.getBoundingBox();this._sprite.size.set(destRect.width,destRect.height);this._sprite.position.set(destRect.x,destRect.y);pintar.drawSprite(this._sprite)}}module.exports=Sprite},{"./pintar":10,"./ui_element":17}],17:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");const Anchors=require("./anchors");const SizeModes=require("./size_modes");const Sides=require("./sides_properties");const UIPoint=require("./ui_point");const Cursors=require("./cursor_types");class UIElementState{constructor(){this.mouseHover=false;this.mouseDown=false}clone(){var ret=new UIElementState;ret.mouseHover=this.mouseHover;ret.mouseDown=this.mouseDown;return ret}}class UIElement{constructor(){this.offset=UIPoint.zero();this.size=new UIPoint(100,"px",100,"px");this.anchor=Anchors.Auto;this.scale=1;this.margin=new Sides(5,5,5,5);this.ignoreParentPadding=false;this.cursor=this._defaultCursor;this._state=new UIElementState;this._prevState=new UIElementState;this.__parent=null;this.interactive=this.isNaturallyInteractive;this.onMouseEnter=null;this.onMouseLeave=null;this.whileMouseHover=null;this.onMousePressed=null;this.onMouseReleased=null;this.whileMouseDown=null}_copyStateFrom(other){this.__copyStateFrom=other}setBaseOptions(options){this.scale=options.scale||this.scale;this.margin=(options.margin||this.margin).clone();this.anchor=options.anchor||this.anchor;this.cursor=options.cursor||this.cursor}get _defaultCursor(){return Cursors.Default}get elementTypeName(){return this.constructor.name}getOptionsFromTheme(theme,skin,override){var elementName=this.elementTypeName;var options=theme[elementName];if(!options){throw new Error("Missing definition for object type '"+elementName+"' in UI theme!")}skin=skin||"default";options=options[skin];if(!options){throw new Error("Missing definition for object type '"+elementName+"' and skin '"+skin+"' in UI theme!")}if(override){var temp={};for(var key in options){temp[key]=options[key]}for(var key in override){temp[key]=override[key]}options=temp}var required=this.requiredOptions;for(var i=0;i<required.length;++i){if(!(required[i]in options)){throw new Error("Missing mandatory option '"+required[i]+"' in element type '"+elementName+"' options!")}}return options}get requiredOptions(){return[]}_setParent(parent){this.__parent=parent}get absoluteScale(){return this.scale*UIElement.globalScale}_convertVal(val,parentSize,mode){switch(mode){case undefined:case SizeModes.Pixels:var scale=this.absoluteScale;return Math.ceil(val*scale);case SizeModes.Percents:return Math.ceil(val/100*parentSize);default:throw new Error("Invalid size mode!")}}_convertSize(val){var parentSize=val.xMode==SizeModes.Percents||val.yMode==SizeModes.Percents?this.getParentInternalBoundingBox().getSize():{x:0,y:0};return new PintarJS.Point(this._convertVal(val.x,parentSize.x,val.xMode),this._convertVal(val.y,parentSize.y,val.yMode))}_convertSides(val){var ret=val.clone();var parentSize=ret.leftMode==SizeModes.Percents||ret.rightMode==SizeModes.Percents||ret.topMode==SizeModes.Percents||ret.bottomMode==SizeModes.Percents?this.getParentInternalBoundingBox().getSize():{x:0,y:0};ret.left=this._convertVal(ret.left,parentSize.x,ret.leftMode);ret.right=this._convertVal(ret.right,parentSize.x,ret.rightMode);ret.top=this._convertVal(ret.top,parentSize.y,ret.topMode);ret.bottom=this._convertVal(ret.bottom,parentSize.y,ret.bottomMode);return ret}getSizeInPixels(){return this._convertSize(this.size)}getOffsetInPixels(){return this._convertSize(this.offset)}get parent(){return this.__parent}get isNaturallyInteractive(){return false}draw(pintar){throw new Error("Not Implemented!")}_triggerEvents(InputManager){if(this.onMouseEnter&&!this._prevState.mouseHover&&this._state.mouseHover){this.onMouseEnter(this,InputManager)}if(this.onMouseLeave&&this._prevState.mouseHover&&!this._state.mouseHover){this.onMouseLeave(this,InputManager)}if(this.whileMouseHover&&this._state.mouseHover){this.whileMouseHover(this,InputManager)}if(this.onMousePressed&&!this._prevState.mouseDown&&this._state.mouseDown){this.onMousePressed(this,InputManager)}if(this.onMouseReleased&&this._prevState.mouseDown&&!this._state.mouseDown&&this._state.mouseHover){this.onMouseReleased(this,InputManager)}if(this.whileMouseDown&&this._state.mouseDown){this.whileMouseDown(this,InputManager)}this._prevState=this._state.clone()}update(input,forceState){if(!this.interactive){return}if(this.__copyStateFrom||forceState){this._state=forceState?forceState.clone():this.__copyStateFrom._state.clone();this._triggerEvents(input);return}var dest=this.getBoundingBox();var mousePos=input.mousePosition;this._state.mouseHover=mousePos.x>=dest.left&&mousePos.x<=dest.right&&mousePos.y>=dest.top&&mousePos.y<=dest.bottom;if(this._state.mouseHover){input.setCursor(this.cursor)}this._state.mouseDown=this._state.mouseHover&&input.leftMouseDown;this._triggerEvents(input)}getBoundingBox(){var position=this.getDestTopLeftPosition();var size=this.getSizeInPixels();return new PintarJS.Rectangle(position.x,position.y,size.x,size.y)}getInternalBoundingBox(){return this.getBoundingBox()}getParentInternalBoundingBox(){if(!this.parent){throw new Error("Missing parent element! Did you forget to create a UI root and add elements to it?")}return this.ignoreParentPadding?this.parent.getBoundingBox():this.parent.getInternalBoundingBox()}getDestTopLeftPositionForRect(parentRect,selfSize,anchor,offset){var ret=new PintarJS.Point(0,0);var offsetFactor=new PintarJS.Point(1,1);switch(anchor){case Anchors.TopLeft:case Anchors.Auto:case Anchors.AutoInline:ret.set(parentRect.x,parentRect.y);break;case Anchors.TopCenter:ret.set(parentRect.x+parentRect.width/2-selfSize.x/2,parentRect.y);break;case Anchors.TopRight:ret.set(parentRect.right-selfSize.x,parentRect.y);offsetFactor.x=-1;break;case Anchors.CenterLeft:ret.x=parentRect.x;ret.y=parentRect.y+parentRect.height/2-selfSize.y/2;break;case Anchors.Center:ret.x=parentRect.x+parentRect.width/2-selfSize.x/2;ret.y=parentRect.y+parentRect.height/2-selfSize.y/2;break;case Anchors.CenterRight:ret.x=parentRect.right-selfSize.x;ret.y=parentRect.y+parentRect.height/2-selfSize.y/2;offsetFactor.x=-1;break;case Anchors.BottomLeft:ret.x=parentRect.x;ret.y=parentRect.bottom-selfSize.y;offsetFactor.y=-1;break;case Anchors.BottomCenter:ret.x=parentRect.x+parentRect.width/2-selfSize.x/2;ret.y=parentRect.bottom-selfSize.y;offsetFactor.y=-1;break;case Anchors.BottomRight:ret.x=parentRect.right-selfSize.x;ret.y=parentRect.bottom-selfSize.y;offsetFactor.x=-1;offsetFactor.y=-1;break}if(offset){ret=ret.add(offset.mul(offsetFactor))}ret.x=Math.floor(ret.x);ret.y=Math.floor(ret.y);return ret}getDestTopLeftPosition(){if(this.anchor===Anchors.Fixed){return this.offset.clone()}var parentRect=this.getParentInternalBoundingBox();var selfSize=this.getSizeInPixels();var offset=this.getOffsetInPixels();if(this.__cachedTopLeftPos&&this.anchor===this.__lastAnchor&&selfSize.equals(this.__lastSize||PintarJS.Point.zero())&&offset.equals(this.__lastOffset||PintarJS.Point.zero())&&parentRect.equals(this.__lastParentRect||new PintarJS.Rectangle)){return this.__cachedTopLeftPos}var ret=this.getDestTopLeftPositionForRect(parentRect,selfSize,this.anchor,offset);this.__cachedTopLeftPos=ret.clone();this.__lastAnchor=this.anchor;this.__lastSize=selfSize;this.__lastOffset=offset;this.__lastParentRect=parentRect.clone();return ret}getCenterPosition(){var bb=this.getBoundingBox();return bb.getCenter()}}UIElement.globalScale=1;module.exports=UIElement},{"./anchors":1,"./cursor_types":4,"./pintar":10,"./sides_properties":13,"./size_modes":14,"./ui_point":18}],18:[function(require,module,exports){"use strict";const PintarJS=require("./pintar");const SizeModes=require("./size_modes");class UIPoint extends PintarJS.Point{constructor(x,modeX,y,modeY){super(x,y);this.xMode=modeX||SizeModes.Pixels;this.yMode=modeY||SizeModes.Pixels}clone(){return new UIPoint(this.x,this.xMode,this.y,this.yMode)}equals(other){return other&&this.x==other.x&&this.y==other.y&&this.xMode==other.xMode&&this.yMode==other.yMode}}UIPoint.zero=function(){return new UIPoint(0,"px",0,"px")};UIPoint.one=function(){return new UIPoint(1,"px",1,"px")};UIPoint.half=function(){return new UIPoint(.5,"px",.5,"px")};module.exports=UIPoint},{"./pintar":10,"./size_modes":14}],19:[function(require,module,exports){"use strict";module.exports={lerp:function(start,end,a){return(1-a)*start+a*end},MoveTowards:function(start,end,a){if(start===end){return end}var sign=Math.sign(end-start);var ret=start+sign*a;if(sign>0&&ret>end){ret=end}else if(sign<0&&ret<end){ret=end}return ret}}},{}]},{},[6])(6)});