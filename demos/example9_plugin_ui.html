<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>PintarJS - Demos</title>
    <script src="../dist/pintar.js"></script>
    <script src="../dist/pintar.ui.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css" media="all">
    <style>
        @font-face {
          font-family: "ui-font";
          src: url("imgs/FFFFORWA.TTF");
        }
    </style>
  </head>
  <body>

    <!-- to make sure our font is preloaded when we create the font texture -->
    <div style="font-family: ui-font; position:fixed; top: -1000px;">.</div>

    <!-- container and canvas -->
    <div class="container container-int">
      <br />
      <h1>Example 9: UI plugin - WORK IN PROGRESS</h1>
      <p>PintarJS comes with an optional UI plugin. <br />
	       Here are some examples of built-in UI elements.</p> <br /><br />

      <canvas style="cursor: none !important;"></canvas>
    </div>

    <script>
      // enable debug mode
      //PintarJS.enableDebugMessages();

      // set default renderer
      var mode = location.search.substr(1).split('?')[0];
      PintarJS.DefaultRenderers = PintarJS.Renderers[mode] || PintarJS.DefaultRenderers;
      
      // initialize pintar
      var pintar = new PintarJS();
      pintar.clearColor = PintarJS.Color.lavender();

      // adjust size
      pintar.adjustToParentSize();
      window.onresize = () => {
        pintar.adjustToParentSize();
      };

      // set pixelated by default
      PintarJS.Sprite.defaults.smoothingEnabled = false;

      // load ui texture
      var uiTexture = new PintarJS.Texture("imgs/ui.png");

      // global texture scale
      const textureScale = 5;
      var fontsScale = textureScale / 5;

      // font name to use
      var fontName = "ui-font";

      // define the UI theme
      var UI_THEME = 
      {
        // define cursors
        Cursor:
        {
          // default cursors skin
          default: 
          {
            texture: uiTexture,
            textureScale: textureScale,
            defaultSourceRect: new PintarJS.Rectangle(65, 3, 8, 8),
            pointerSourceRect: new PintarJS.Rectangle(65 + 8 + 1, 3, 8, 8),
            pointerDownSourceRect: new PintarJS.Rectangle(65 + 16 + 2, 3, 8, 8),
          }
        },

        // define panel types
        Panel: 
        {
          // default panel
          default: {
            texture: uiTexture,
            externalSourceRect: new PintarJS.Rectangle(0, 32, 64, 64),
            internalSourceRect: new PintarJS.Rectangle(5, 37, 54, 54),
            textureScale: textureScale,
            fillMode: PintarJS.UI.SlicedSprite.FillModes.Tiled,
            fillColor: PintarJS.Color.white(),
            frameColor: PintarJS.Color.white(),
            padding: new PintarJS.UI.SidesProperties(30, 30, 30, 30),
          }
        },

        // define horizontal lines
        HorizontalLine:
        {
          // default horizontal line
          default: {
            texture: uiTexture,
            textureScale: textureScale,
            startEdgeSourceRect: new PintarJS.Rectangle(64, 0, 2, 2),
            endEdgeSourceRect: new PintarJS.Rectangle(94, 0, 2, 2),
            middleSourceRect: new PintarJS.Rectangle(66, 0, 28, 2),
            margin: new PintarJS.UI.SidesProperties(0, 0, 0, 20),
          },
        },
        
        // define slider types
        Slider:
        {
          // default slider
          default: {
            texture: uiTexture,
            textureScale: textureScale,
            startEdgeSourceRect: new PintarJS.Rectangle(64, 64, 5, 8),
            middleSourceRect: new PintarJS.Rectangle(69, 64, 22, 8),
            endEdgeSourceRect: new PintarJS.Rectangle(91, 64, 5, 8),
            handleSourceRect: new PintarJS.Rectangle(64, 73, 5, 8),
            margin: new PintarJS.UI.SidesProperties(0, 0, 0, 0),
            direction: "horizontal",
          },
        },

        // define progressbars
        ProgressBar: 
        {
          // default progressbar
          default: {
            texture: uiTexture,
            fillExternalSourceRect: new PintarJS.Rectangle(2, 13, 60, 4),
            fillInternalSourceRect: new PintarJS.Rectangle(4, 14, 56, 2),
            backgroundExternalSourceRect: new PintarJS.Rectangle(0, 0, 64, 10),
            backgroundInternalSourceRect: new PintarJS.Rectangle(4, 4, 56, 2),
            foregroundExternalSourceRect: new PintarJS.Rectangle(0, 20, 64, 10),
            foregroundInternalSourceRect: new PintarJS.Rectangle(4, 24, 56, 2),
            fillOffset: new PintarJS.Point(2 * textureScale, 3 * textureScale),
            textureScale: textureScale,
            fillColor: PintarJS.Color.red(),
            backgroundColor: PintarJS.Color.white(),
            valueSetWidth: true,
            valueSetHeight: false,
            animationSpeed: 1,
          },

          // hp orb
          orb: {
            texture: uiTexture,
            fillSourceRect: new PintarJS.Rectangle(32, 96, 32, 32),
            backgroundSourceRect: new PintarJS.Rectangle(0, 96, 32, 32),
            foregroundSourceRect: new PintarJS.Rectangle(64, 96, 32, 32),
            fillOffset: new PintarJS.Point(0, 0),
            textureScale: textureScale,
            fillColor: PintarJS.Color.red(),
            backgroundColor: PintarJS.Color.white(),
            valueSetWidth: false,
            valueSetHeight: true,
            fillAnchor: "BottomCenter",
            animationSpeed: 1,
          },

          // vertical bar
          vertical: {
            texture: uiTexture,
            fillExternalSourceRect: new PintarJS.Rectangle(116, 105, 8, 14),
            fillInternalSourceRect: new PintarJS.Rectangle(116+2, 105+1, 8-4, 14-2),
            backgroundExternalSourceRect: new PintarJS.Rectangle(96, 96, 16, 32),
            backgroundInternalSourceRect: new PintarJS.Rectangle(96+4, 96+9, 16-8, 32-18),
            fillOffset: new PintarJS.Point(0, 9 * textureScale),
            textureScale: textureScale,
            fillColor: PintarJS.Color.green(),
            backgroundColor: PintarJS.Color.white(),
            valueSetWidth: false,
            valueSetHeight: true,
            height: 200,
            fillAnchor: "BottomCenter",
            animationSpeed: 1,
          }
        },

        // define paragraphs
        Paragraph: 
        {
          // default paragraph
          default: {
            font: fontName,
            fontSize: 12 * fontsScale,
            fillColor: PintarJS.Color.white(),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 6,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },

          // paragraph for buttons
          buttons: {
            font: fontName,
            fontSize: 16 * fontsScale,
            fillColor: PintarJS.Color.white(),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 6,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },

          // paragraph for buttons hover
          buttonsHover: {
            font: fontName,
            fontSize: 16 * fontsScale,
            fillColor: PintarJS.Color.white(),
            strokeColor: PintarJS.Color.fromHex("#d27d2c"),
            strokeWidth: 6,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },

          // paragraph for buttons down
          buttonsDown: {
            font: fontName,
            fontSize: 16 * fontsScale,
            fillColor: new PintarJS.Color(0.9, 0.9, 0.9, 1),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 6,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },

          // headers
          header: {
            font: fontName,
            fontSize: 18 * fontsScale,
            fillColor: PintarJS.Color.yellow(),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 8,
            useStyleCommands: false,
            margin: new PintarJS.UI.SidesProperties(8, 8, 12, 0),
          },

          // small paragraph
          small: {
            font: fontName,
            fontSize: 9,
            fillColor: new PintarJS.Color(0.8, 0.8, 0.8, 1),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 5,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },
        },

        // Button
        Button: 
        {
          // default button
          default: {
            texture: uiTexture,
            externalSourceRect: new PintarJS.Rectangle(64, 16, 32, 16),
            internalSourceRect: new PintarJS.Rectangle(64 + 5, 16 + 5, 32 - 10, 16 - 10),
            mouseDownExternalSourceRect: new PintarJS.Rectangle(64, 32, 32, 16),
            mouseDownInternalSourceRect: new PintarJS.Rectangle(64 + 5, 32 + 5, 32 - 10, 16 - 10),
            mouseHoverExternalSourceRect: new PintarJS.Rectangle(64, 48, 32, 16),
            mouseHoverInternalSourceRect: new PintarJS.Rectangle(64 + 5, 48 + 5, 32 - 10, 16 - 10),
            paragraphSkin: "buttons",
            mouseHoverParagraphSkin: "buttonsHover",
            mouseDownParagraphSkin: "buttonsDown",
            textureScale: textureScale,   
          },

          // toggle button
          toggle: {
            extends: 'default',
            toggleMode: true,
          },

          // a button that is just text
          textOnly: {
            texture: uiTexture,
            paragraphSkin: "buttons",
            mouseHoverParagraphSkin: "buttonsHover",
            mouseDownParagraphSkin: "buttonsDown",
            textureScale: textureScale,
            heightInPixels: 60,
          }
        }
      };

      // create root
      var root = new PintarJS.UI.UIRoot(pintar, null);

      // next container position x
      var marginX = 10;
      var positionX = marginX;
      var containersHeight = 490;
      var totalWidth = 0;
      var firstContainer = null;

      // set cursor
      var cursor = new PintarJS.UI.Cursor(UI_THEME);
      root.setCursor(cursor);

      // function to create a container for an example
      var createContainer = (title) => {

        // create container
        var container = new PintarJS.UI.Panel(UI_THEME);
        container.anchor = PintarJS.UI.Anchors.AutoInlineNoBreak;
        container.size.set(370, containersHeight);
        container.margin.set(10, 10, 10, 10);
        root.addChild(container);
        totalWidth += 10 + 370;

        // set first container
        firstContainer = firstContainer || container;

        // add title
        var header = new PintarJS.UI.Paragraph(UI_THEME, "header");
        header.text = title;
        container.addChild(header);
        container.addChild(new PintarJS.UI.HorizontalLine(UI_THEME));

        // return container
        return container;
      }

      // WELCOME MESSAGE
      {
        // create example's container
        var container = createContainer("Welcome to Pintar.UI !");
        var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "default");
        paragraph.text = "This is a basic {{fc:yellow}}Pintar.UI{{res}} demo. The UI theme you see before you was created for this demo (and you can use it for any purpose if you like), but know that {{fc:yellow}}Pintar.UI{{res}} is very flexible and can work with any texture and theme -- you just need to define it as seen in this page's code.\n\nTo see more UI elements, {{fc:yellow}}scroll to the right{{res}} using the scrollbar on the bottom.\n\nTo learn more, check out this page source or visit:\n{{fc:yellow}}github.com/RonenNess/PintarJS{{res}}";
        container.addChild(paragraph);
      }

      // BUTTONS
      {
        // create example's container
        var container = createContainer("Buttons:");
        
        // create a button element
        var button = new PintarJS.UI.Button(UI_THEME);
        button.anchor = PintarJS.UI.Anchors.Auto;
        button.text = "Don't Click Me!";
        button.onMouseReleased = (btn, input) => { alert("Why would you do this? :("); }
        container.addChild(button);

        // create a button element with text only
        button = new PintarJS.UI.Button(UI_THEME, "textOnly");
        button.anchor = PintarJS.UI.Anchors.Auto;
        button.text = "Text-only button";
        button.onMouseReleased = (btn, input) => { alert("I don't know what you expected."); }
        container.addChild(button);

        // toggle button text
        container.addChild(new PintarJS.UI.HorizontalLine(UI_THEME));
        var toggleDesc = new PintarJS.UI.Paragraph(UI_THEME);
        toggleDesc.text = "Buttons can behave like checkboxes and be toggled. Check out this button for example:"
        container.addChild(toggleDesc);

        // create a toggle button
        var toggleButton = new PintarJS.UI.Button(UI_THEME, "toggle");
        toggleButton.anchor = PintarJS.UI.Anchors.Auto;
        toggleButton.text = "Toggle Button";
        container.addChild(toggleButton);

        // register to toggle button changed event
        var btnState = new PintarJS.UI.Paragraph(UI_THEME);
        toggleButton.afterValueChanged = () => {
          btnState.text = "Toggle Value: " + toggleButton.isChecked;
        }
        toggleButton.afterValueChanged();
        container.addChild(btnState);
      }

      // PROGRESS BARS
      var progressbars = [];
      {
        // create example's container
        var container = createContainer("Progress Bars:");

        var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "default");
        paragraph.text = "Progress bars display values ranging from {{fc:yellow}}0.0{{res}} to {{fc:yellow}}1.0{{res}}. They are useful for things like HP bars, loadings, ect.";
        container.addChild(paragraph);

        var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "small");
        paragraph.text = "In this demo values change randomly.";
        container.addChild(paragraph);

        // create progressbar element
        var progressbar = new PintarJS.UI.ProgressBar(UI_THEME);
        progressbar.anchor = PintarJS.UI.Anchors.Auto;
        progressbar.value = 0.85;
        container.addChild(progressbar);
        progressbars.push(progressbar);

        // create additional progressbar, but align to right and set green color
        progressbar = new PintarJS.UI.ProgressBar(UI_THEME, null, {fillAnchor: "TopRight", fillColor: PintarJS.Color.green()});
        progressbar.anchor = PintarJS.UI.Anchors.Auto;
        progressbar.value = 0.7;
        container.addChild(progressbar);
        progressbars.push(progressbar);

        // create additional progressbar, but align to center and set yellow color
        progressbar = new PintarJS.UI.ProgressBar(UI_THEME, null, {fillAnchor: "Center", fillColor: PintarJS.Color.yellow(), fillOffset: null});
        progressbar.anchor = PintarJS.UI.Anchors.Auto;
        progressbar.value = 0.65;
        container.addChild(progressbar);
        progressbars.push(progressbar);
        
        // create additional progressbar, on Y axis
        progressbar = new PintarJS.UI.ProgressBar(UI_THEME, null, {fillAnchor: "BottomLeft", fillColor: PintarJS.Color.purple(), valueSetWidth:false, valueSetHeight: true});
        progressbar.anchor = PintarJS.UI.Anchors.Auto;
        progressbar.value = 0.65;
        progressbar.size.y = 100;
        container.addChild(progressbar);
        progressbars.push(progressbar);
      }

      
      // PROGRESS BARS II
      {
        // create example's container
        var container = createContainer("More Progress Bars:");

        var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "default");
        paragraph.text = "Progress bars are very flexible. For example, you can make them look like classic HP orbs!";
        container.addChild(paragraph);

        var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "small");
        paragraph.text = "In this demo values change randomly.";
        container.addChild(paragraph);

        // create health orb
        progressbar = new PintarJS.UI.ProgressBar(UI_THEME, "orb");
        progressbar.anchor = PintarJS.UI.Anchors.Auto;
        progressbar.value = 0.7;
        container.addChild(progressbar);
        progressbars.push(progressbar);

        // add text display
        var text = new PintarJS.UI.Paragraph(UI_THEME);
        text.anchor = PintarJS.UI.Anchors.Center;
        text.text = "100%";
        text.alignment = "center";
        progressbar.addChild(text);

        // update health orb text
        progressbar.beforeUpdate = () => {
          text.text = Math.round(progressbar.displayedValue * 100) + '%';
        };

        // add vertical bar
        progressbar = new PintarJS.UI.ProgressBar(UI_THEME, "vertical");
        progressbar.anchor = PintarJS.UI.Anchors.BottomRight;
        progressbar.value = 0.5;
        container.addChild(progressbar);
        progressbars.push(progressbar);
      }

      // set random values every few seconds for progress bars
      setInterval(() => 
      {
        for (var i = 0; i < progressbars.length; ++i) {
          progressbar = progressbars[i];
          progressbar.value = Math.random();
        }
      }, 5000);

      // create bottom slider
      var scrollbar = new PintarJS.UI.Slider(UI_THEME);
      scrollbar.anchor = PintarJS.UI.Anchors.BottomCenter;
      scrollbar.size.x = 98.5;
      scrollbar.value = 0;
      root.addChild(scrollbar);

      // set offset from scrollbar
      scrollbar.afterValueChanged = () => {
        firstContainer.margin.left = (-totalWidth + pintar.canvas.width) * scrollbar.getValuePercent();
      }

      // draw everything
      function drawUI()
      {
        // start frame
        pintar.startFrame();

        // update & draw ui elements
        root.update();
        root.draw();

        // end frame
        pintar.endFrame();
        requestAnimationFrame(drawUI);
      }

      // start drawing UIs, but only when fonts are ready
      document.fonts.onloadingdone = function (fontFaceSetEvent) {
        drawUI();
      };
    </script>
  </body>
</html>