<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>PintarJS - Demos</title>
    <script src="../dist/pintar.js"></script>
    <script src="../dist/pintar.ui.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css" media="all">
    <style>
        @font-face {
          font-family: "ui-font";
          src: url("imgs/FFFFORWA.TTF");
        }
    </style>
  </head>
  <body>

    <!-- to make sure our font is preloaded when we create the font texture -->
    <div style="font-family: ui-font; position:fixed; top: -1000px;">.</div>

    <!-- container and canvas -->
    <div class="container container-int">
      <br />
      <h1>Example 9: UI plugin</h1>
      <p>PintarJS comes with an optional UI plugin. <br />
	       Here are some examples of built-in UI elements.</p> <br /><br />

      <canvas></canvas>
    </div>

    <script>
      // enable debug mode
      //PintarJS.enableDebugMessages();

      // set default renderer
      var mode = location.search.substr(1).split('?')[0];
      PintarJS.DefaultRenderers = PintarJS.Renderers[mode] || PintarJS.DefaultRenderers;
      
      // initialize pintar
      var pintar = new PintarJS();
      pintar.clearColor = PintarJS.Color.lavender();

      // adjust size
      pintar.adjustToParentSize();
      window.onresize = () => {
        pintar.adjustToParentSize();
      };

      // set pixelated by default
      PintarJS.Sprite.defaults.smoothingEnabled = false;

      // load ui texture
      var uiTexture = new PintarJS.Texture("imgs/ui.png");

      // global texture scale
      const textureScale = 5;

      // define the UI theme
      var UI_THEME = 
      {
        // define panel types
        Panel: 
        {
          // default panel
          default: {
            texture: uiTexture,
            externalSourceRect: new PintarJS.Rectangle(0, 32, 64, 64),
            internalSourceRect: new PintarJS.Rectangle(5, 37, 54, 54),
            textureScale: textureScale,
            fillMode: PintarJS.UI.SlicedSprite.FillModes.Tiled,
            fillColor: PintarJS.Color.white(),
            frameColor: PintarJS.Color.white(),
          }
        },

        // define containers
        Container: 
        {
          // default container - with default panel as background
          default: {
            background: "default",
            padding: new PintarJS.UI.SidesProperties(25, 25, 25, 25),
          },

          // alternative container without background
          no_ackground: {
            background: null,
            padding: new PintarJS.UI.SidesProperties(15, 15, 15, 15),
          }
        },

        // define progressbars
        ProgressBar: 
        {
          // default progressbar
          default: {
            texture: uiTexture,
            fillExternalSourceRect: new PintarJS.Rectangle(2, 13, 60, 4),
            fillInternalSourceRect: new PintarJS.Rectangle(4, 14, 56, 2),
            backgroundExternalSourceRect: new PintarJS.Rectangle(0, 0, 64, 10),
            backgroundInternalSourceRect: new PintarJS.Rectangle(4, 4, 56, 2),
            foregroundExternalSourceRect: new PintarJS.Rectangle(0, 20, 64, 10),
            foregroundInternalSourceRect: new PintarJS.Rectangle(4, 24, 56, 2),
            fillOffset: new PintarJS.Point(2 * textureScale, 3 * textureScale),
            textureScale: textureScale,
            fillColor: PintarJS.Color.red(),
            backgroundColor: PintarJS.Color.white(),
            valueSetWidth: true,
            valueSetHeight: false,
            animationSpeed: 1,
          }
        },

        // define paragraphs
        Paragraph: 
        {
          // default paragraph
          default: {
            font: "ui-font",
            fontSize: 12,
            fillColor: PintarJS.Color.white(),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 6,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },

          // headers
          header: {
            font: "ui-font",
            fontSize: 18,
            fillColor: PintarJS.Color.yellow(),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 8,
            useStyleCommands: false,
            margin: new PintarJS.UI.SidesProperties(8, 8, 12, 8),
          },

          // small paragraph
          small: {
            font: "ui-font",
            fontSize: 9,
            fillColor: new PintarJS.Color(0.8, 0.8, 0.8, 1),
            strokeColor: PintarJS.Color.black(),
            strokeWidth: 5,
            useStyleCommands: true,
            margin: new PintarJS.UI.SidesProperties(10, 8, 10, 8),
          },
        },

      };

      // create root
      var root = new PintarJS.UI.UIRoot(pintar, null);

      // create a container
      var container = new PintarJS.UI.Container(UI_THEME);
      container.anchor = PintarJS.UI.Anchors.Center;
      container.size.set(370, 400);
      root.addChild(container);

      // create header paragraph and info text
      var header = new PintarJS.UI.Paragraph(UI_THEME, "header");
      header.text = "Progress Bars:";
      container.addChild(header);

      var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "default");
      paragraph.text = "Progress bars display values from {{fc:yellow}}0.0{{res}} to {{fc:yellow}}1.0{{res}}, useful for things like HP bars, loading screens, ect.";
      container.addChild(paragraph);

      var paragraph = new PintarJS.UI.Paragraph(UI_THEME, "small");
      paragraph.text = "In this demo values change randomly.";
      container.addChild(paragraph);

      // create progressbar element
      var progressbars = [];
      var progressbar = new PintarJS.UI.ProgressBar(UI_THEME);
      progressbar.anchor = PintarJS.UI.Anchors.Auto;
      progressbar.value = 0.85;
      container.addChild(progressbar);
      progressbars.push(progressbar);

      // create additional progressbar, but align to right and set green color
      progressbar = new PintarJS.UI.ProgressBar(UI_THEME, null, {fillAnchor: "TopRight", fillColor: PintarJS.Color.green()});
      progressbar.anchor = PintarJS.UI.Anchors.Auto;
      progressbar.value = 0.7;
      container.addChild(progressbar);
      progressbars.push(progressbar);

      // create additional progressbar, but align to center and set yellow color
      progressbar = new PintarJS.UI.ProgressBar(UI_THEME, null, {fillAnchor: "Center", fillColor: PintarJS.Color.yellow(), fillOffset: null});
      progressbar.anchor = PintarJS.UI.Anchors.Auto;
      progressbar.value = 0.65;
      container.addChild(progressbar);
      progressbars.push(progressbar);

      // set random values every few seconds for progress bars
      setInterval(() => {
        for (var i = 0; i < progressbars.length; ++i) {
          progressbars[i].value = Math.random();
        }
      }, 5000);

      // draw everything
      function drawUI()
      {
        // start frame
        pintar.startFrame();

        // update & draw ui elements
        root.update();
        root.draw();

        // end frame
        pintar.endFrame();
        requestAnimationFrame(drawUI);
      }

      // start drawing UIs, but only when fonts are ready
      document.fonts.onloadingdone = function (fontFaceSetEvent) {
        drawUI();
      };
    </script>
  </body>
</html>